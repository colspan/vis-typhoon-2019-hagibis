!function(t){function e(e){for(var o,i,c=e[0],l=e[1],s=e[2],d=0,u=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&u.push(r[i][0]),r[i]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);for(p&&p(e);u.length;)u.shift()();return a.push.apply(a,s||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],o=!0,c=1;c<n.length;c++){var l=n[c];0!==r[l]&&(o=!1)}o&&(a.splice(e--,1),t=i(i.s=n[0]))}return t}var o={},r={0:0},a=[];function i(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=o,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var s=0;s<c.length;s++)e(c[s]);var p=l;a.push([62,1]),n()}({38:function(t,e){},40:function(t,e){},58:function(t,e){},60:function(t,e,n){var o=n(61);"string"==typeof o&&(o=[[t.i,o,""]]);var r={hmr:!0,transform:void 0};n(16)(o,r);o.locals&&(t.exports=o.locals)},61:function(t,e,n){(t.exports=n(14)(!1)).push([t.i,".map-title {\n    background-color: rgba(96, 210, 255, 0.2);\n    border-color: rgb(98, 179, 255);\n    border-style: solid;\n    border-width:1px;\n    padding: 2px 10px;\n    color: rgb(98, 179, 255);\n}\n.map-title h1 {\n    font-size: 48pt;\n    margin: 0;\n}\n\n.map-indicator {\n    background-color: rgba(96, 210, 255, 0.2);\n    border-color: rgb(98, 179, 255);\n    border-style: solid;\n    border-width:1px;\n    padding: 2px 10px;\n    color: white;\n    padding: 2px 10px;\n}\n.map-indicator .datetime {\n    font-size: 42pt;\n}\n\n.leaflet-tile-container img {\n    filter: invert(100%) hue-rotate(180deg);\n}\n",""])},62:function(t,e,n){"use strict";n.r(e);var o=n(24),r=n.n(o),a=n(0),i=n.n(a);n(27);delete i.a.Icon.Default.prototype._getIconUrl,i.a.Icon.Default.mergeOptions({iconRetinaUrl:n(33),iconUrl:n(15),shadowUrl:n(34)}),i.a.Control.Title=i.a.Control.extend({onAdd:function(t){const e=i.a.DomUtil.create("div");return e.className="map-title",e.innerHTML=`<h1>${this.options.title}</h1>`,e},onRemove:function(t){}}),i.a.control.title=function(t){return new i.a.Control.Title(t)},i.a.Control.Indicator=i.a.Control.extend({onAdd:function(t){const e=i.a.DomUtil.create("div");return e.className="map-indicator",e},onRemove:function(t){}}),i.a.control.indicator=function(t){return new i.a.Control.Indicator(t)};var c=n(13),l=n.n(c);n(60);const s=i.a.map("map",{zoom:11,center:[35.758771,139.794158],zoomControl:!1}),p=['Tiles &copy; <a href="https://maps.gsi.go.jp/development/ichiran.html">国土地理院</a>','River log &copy; <a href="http://www1.river.go.jp/">国土交通省 水文水質データベース</a>','Visualization &copy; <a href="https://github.com/colspan">@colspan</a>','Typhoon Track Log &copy; <a href="http://agora.ex.nii.ac.jp/digital-typhoon/summary/wnp/s/201919.html.ja">国立情報学研究所「デジタル台風」</a>'].join(" | ");i.a.tileLayer("https://cyberjapandata.gsi.go.jp/xyz/pale/{z}/{x}/{y}.png",{attribution:p}).addTo(s);i.a.control.title({title:"2019年 台風19号 各河川水位可視化",position:"topleft"}).addTo(s);i.a.control.zoom({position:"bottomright"}).addTo(s),Promise.all([new Promise((t,e)=>{fetch("./siteinfo.csv").then(t=>t.text()).then(t=>l()(t,{mapValues:({header:t,index:e,value:n})=>{if("coordinate"===t){function o(t){const e=new RegExp("[度分秒]"),n=t.split(e);return+n[0]+ +n[1]/60+ +n[2]/60/60}const t=n.split(" ");return[o(t[1]),o(t[3])]}return n}})).then(t).catch(e)}),new Promise((t,e)=>{fetch("./riverlog_201910.csv").then(t=>t.text()).then(t=>l()(t,{mapValues:({header:t,index:e,value:n})=>"datetime"===t?n:""===n?NaN:+n})).then(t).catch(e)}),new Promise((t,e)=>{fetch("./201919.ja.json").then(t=>t.json()).then(e=>{const n=e.features.map(t=>{const e=t.properties.time,n=t.geometry.coordinates;return{[e]:[n[1],n[0]]}}).reduce((t,e)=>Object.assign(t,e),{});t(n)}).catch(e)})]).then(t=>{const[e,n,o]=t,a=e.filter(t=>16===t.site_id.length),c=a.map(t=>{const e=n.map(e=>e[t.site_id]).filter(t=>!isNaN(t)),o=e.reduce((t,e)=>t>e?t:e),r=e.reduce((t,e)=>t<e?t:e);return e.forEach((t,e)=>{isNaN(t)&&(n[e][t.site_id]=r)}),[o,r]});let l=0;const p=r()({colormap:"portland",nshades:30,format:"hex",alpha:1}),d=a.map(t=>{const e=i.a.circleMarker(t.coordinate,{weight:1}).addTo(s),n=`${t.site_name}`;return e.bindTooltip(n),e.site_id=t.site_id,e});const u=i.a.control.indicator({position:"bottomleft"}).addTo(s);const f=Object.keys(o).map(t=>+t),h=Object.values(o);i.a.polyline(h,{color:"yellow",weight:1}).addTo(s);const m=i.a.marker(h[0]);m.addTo(s),setInterval(()=>{l+=1,n.length<=l&&(l=0),d.forEach((t,e)=>{let o=n[l][t.site_id];const[r,a]=c[e],i=p[parseInt((o-a)/(r-a)*(p.length-1),10)];isNaN(o)?t.setRadius(1):(t.setRadius(10*(o-a)+5),t.setStyle({color:i,fillColor:i}))}),function(){const t=`<div class="datetime">${n[l].datetime}</div>`;u.getContainer().innerHTML=t}(),function(){const t=Date.parse(n[l].datetime)/1e3,e=f.reduce((e,n,o)=>n<=t?o:e,0);let o;if(0===e||e===h.length-1)o=h[e];else{h[e],h[e+1];const n=(t,e,n,o)=>(e[n+1]-e[n])/(t[n+1]-t[n])*(o-t[n])+e[n];o=[n(f,h.map(t=>t[0]),e,t),n(f,h.map(t=>t[1]),e,t)]}m.setLatLng(o)}()},100)}).catch(console.error)}});